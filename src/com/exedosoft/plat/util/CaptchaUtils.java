package com.exedosoft.plat.util;

import java.io.OutputStream;
import java.util.Random;


/**
 * 用于生成gif格式的验证码
 * @author dongliu
 *
 */
public class CaptchaUtils {
        private static final byte[][][] RS = {
                {
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,100,100,100,100,100,100,100,100,100,127,127,127,127,127,},
                        {127,127,127,127,100,100,100,100,100,100,100,100,100,100,100,100,100,127,127,127,},
                        {127,127,127,100,100,100,127,127,127,127,127,127,127,127,127,100,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,100,127,127,127,127,127,127,127,127,127,100,100,100,127,127,},
                        {127,127,127,127,100,100,100,100,100,100,100,100,100,100,100,100,100,127,127,127,},
                        {127,127,127,127,127,127,100,100,100,100,100,100,100,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        },
                        {
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,100,100,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,100,100,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,100,100,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,127,127,},
                        {127,127,127,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        },
                        {
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,100,127,127,127,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,127,100,100,100,127,127,127,127,127,127,127,127,100,100,100,127,127,},
                        {127,127,127,127,100,100,127,127,127,127,127,127,127,127,100,100,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,127,127,100,100,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,127,100,100,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,100,100,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,100,100,100,127,127,127,127,100,100,127,127,},
                        {127,127,127,127,100,100,100,100,100,100,100,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,127,127,100,100,100,100,127,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        },
                        {
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,100,100,127,127,127,127,127,127,127,100,100,127,127,127,127,},
                        {127,127,127,127,100,100,100,127,127,127,127,127,127,127,100,100,100,127,127,127,},
                        {127,127,127,100,100,100,127,127,127,127,127,127,127,127,127,100,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,100,100,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,100,127,127,100,100,100,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,127,100,100,100,100,100,127,100,100,127,127,127,100,100,100,127,127,},
                        {127,127,127,127,127,100,100,100,100,127,100,100,100,100,100,100,100,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,100,100,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        },
                        {
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,100,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,100,100,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,100,100,100,127,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,100,100,100,127,127,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,100,100,127,127,127,127,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,100,100,100,127,127,127,127,127,100,100,127,127,127,127,127,},
                        {127,127,127,127,100,100,100,100,100,100,100,100,100,100,100,100,100,100,127,127,},
                        {127,127,127,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        },
                        {
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,100,100,100,100,127,127,127,100,100,127,127,127,127,},
                        {127,127,127,100,100,100,100,100,100,100,100,127,127,127,100,100,100,127,127,127,},
                        {127,127,127,100,100,100,100,127,127,100,127,127,127,127,127,100,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,100,100,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,100,100,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,100,100,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,100,100,100,127,127,127,127,100,100,127,127,127,},
                        {127,127,127,100,100,127,127,127,127,100,100,100,100,100,100,100,100,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,100,100,100,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        },
                        {
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,100,100,100,100,100,100,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,100,100,100,100,100,100,100,100,100,100,100,100,127,127,127,},
                        {127,127,127,127,100,100,100,127,127,100,100,127,127,127,127,100,100,127,127,127,},
                        {127,127,127,100,100,127,127,127,100,100,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,100,100,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,100,100,127,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,100,127,127,100,100,100,127,127,127,127,100,100,100,127,127,},
                        {127,127,127,127,100,100,100,127,127,100,100,100,100,100,100,100,100,127,127,127,},
                        {127,127,127,127,127,100,100,127,127,127,100,100,100,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        },
                        {
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,127,127,127,100,100,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,100,100,100,100,100,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,100,100,100,100,100,127,127,127,127,127,127,},
                        {127,127,127,100,100,127,127,100,100,100,100,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,100,100,127,100,100,100,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,100,100,100,100,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        },
                        {
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,100,100,100,100,127,127,100,100,100,100,100,127,127,127,127,},
                        {127,127,127,127,100,100,100,100,100,100,100,100,100,100,100,100,100,127,127,127,},
                        {127,127,127,100,100,100,127,127,100,100,100,100,127,127,127,100,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,100,100,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,100,100,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,100,100,127,127,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,100,127,127,100,100,100,100,127,127,127,100,100,100,127,127,},
                        {127,127,127,127,100,100,100,100,100,100,100,100,100,100,100,100,100,127,127,127,},
                        {127,127,127,127,127,100,100,100,100,127,127,127,100,100,100,100,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        },
                        {
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,100,100,100,100,100,127,127,127,100,100,127,127,127,127,},
                        {127,127,127,127,100,100,100,100,100,100,100,100,127,127,100,100,100,127,127,127,},
                        {127,127,127,100,100,100,127,127,127,127,100,100,100,127,127,100,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,100,100,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,100,100,127,127,127,100,100,127,127,},
                        {127,127,127,100,100,127,127,127,127,127,127,100,100,127,127,127,100,100,127,127,},
                        {127,127,127,127,100,100,127,127,127,127,100,100,127,127,127,100,100,127,127,127,},
                        {127,127,127,127,100,100,100,100,100,100,100,100,100,100,100,100,100,127,127,127,},
                        {127,127,127,127,127,127,100,100,100,100,100,100,100,100,100,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        {127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,},
                        },

        };

        public static void generate(String code, OutputStream out){
               
                int codeLen = code.length();
                int width = RS[0][0].length ;
                int height = RS[0].length;
                byte[][] res = new byte[height * codeLen][width];
                for(int i=0; i<codeLen; i++){
                        int seq = code.charAt(i) - '0';
                        for(int j=0;j<height; j++){
                                for(int k=0; k<width; k++){
                                        res[i*height + j][k] = RS[seq][j][k];
                                }
                        }                      
                }

                GIFEncoder encoder;

                try {
                        encoder = new GIFEncoder(res, res, res);
                        encoder.Write(out);
                } catch (Exception e) {
                        e.printStackTrace();
                }

        }
       
        public static String random(){
                String code = "";
                Random random = new Random();
                for(int i=0; i<4; i++){
                        code += Math.abs(random.nextInt()%10);
                }
                return code;
        }
}

